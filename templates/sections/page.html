{% extends "base.html" %}

{% import "macros/qna.html" as qna_macro %}

{% block additionalResources %}

<title>{{ page.title }} | Dynamotivation</title>
<link rel="stylesheet" href={{ get_url(path="css/sections/page.css" ) }}>
{% block moreAdditionalResources %} {% endblock %}

<script src={{ get_url(path="js/blogPage.js" ) }} defer></script>
<script src={{ get_url(path="js/gdprVideo.js" ) }} defer></script>


<meta name="title" content="{{ page.title }} | Dynamotivation">

{% if page.extra.in_sitemap is defined and page.extra.in_sitemap == false %}
<meta name="robots" content="noindex, nofollow">
{% else %}
<meta name="description" content="{{ page.description }}">
<meta name="author" content="Dynamotivation">

{% if page.taxonomies %}
<meta name="keywords" content="{{ page.taxonomies.tags | join(sep=", ") }}">
{% endif %}

<!-- Canonical URL -->
<link rel="canonical" href="{{ page.permalink | safe }}">
{% block article_meta %}{% endblock %}

{% block jsonld %}
{%- if page.extra["project_title"] is defined %}
{%- set _title = page.extra["project_title"] %}
{%- elif page.title is defined %}
{%- set _title = page.title %}
{%- else %}
{%- set _title = "Project" %}
{%- endif %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "@id": "{{ page.permalink | safe }}#webpage",
  "isPartOf": {
    "@type": "WebSite",
    "name": "{{ page.extra.site_name | default(value='Dynamotivation') }}",
    "url": "{{ page.extra.site_url | default(value=get_url(path='', trailing_slash=true)) | safe }}"
  }{% if page.permalink %},
  "url": "{{ page.permalink | safe }}"{% endif %}{% if page.title %},
  "name": "{{ page.title }} | Dynamotivation"{% endif %}{% if page.description %},
  "description": "{{ page.description }}"{% endif %}
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ get_url(path='', trailing_slash=true) | safe }}"
    }{% if page.title and page.permalink %},
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ page.title }}",
      "item": "{{ page.permalink | safe }}"
    }{% endif %}
  ]
}
</script>

{% set faq_items = [] %}
{% if page.extra.faq and page.extra.faq | length > 0 %}
  {% set faq_items = page.extra.faq %}
{% elif page.extra.questions and page.extra.questions | length > 0 %}
  {% set faq_items = page.extra.questions %}
{% endif %}

{% if faq_items | length > 0 %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {% for qa in faq_items %}
    {
      "@type": "Question",
      "name": "{% if qa.q is defined %}{{ qa.q }}{% else %}{{ qa.question }}{% endif %}",
      "acceptedAnswer": { "@type": "Answer", "text": "{% if qa.a is defined %}{{ qa.a | safe }}{% else %}{{ qa.answer | safe }}{% endif %}" }
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ]
}
</script>
{% endif %}
{% endblock %}

{% endif %}

{% endblock additionalResources %}

{% block content %}
{%- if page.extra["project_title"] is defined %}
{%- set _title = page.extra["project_title"] %}
{%- elif page.title is defined %}
{%- set _title = page.title %}
{%- else %}
{%- set _title = "Project" %}
{%- endif %}

<main id="pageContainer">
    <div id="fade-out-top"></div>
    <div id="titleContainer">
        <h1 id="pageTitle" style="view-transition-name: {{ hash_letters::hash_letters(input=page.title) }}">{{ _title }}</h1>
        <noscript>
            <hr>
        </noscript>
    </div>
    <div id="stickyContainer" class="jsOnly">
        <hr id="progressHr">
    </div>
    <div id="dateContainer">
        {% if page.date %}
        <p>Date: <span style="view-transition-name: {{ hash_letters::hash_letters(input=page.date) }}">{{ page.date }}</span></p>
        {% endif %}
        {% if page.updated %}
        <p>Updated: {{ page.updated }}</p>
        {% endif %}
    </div>
    <div id="contentContainer">
        {{ page.content | safe }}
        {% if page.extra.questions and page.extra.questions | length > 0 %}
        <h2 id="faq">Frequently Asked Questions</h1>
        <hr>
        <section id="faq-section">
            {{ qna_macro::qna(items=page.extra.questions) }}
        </section>
        {% endif %}
    </div>
    {% if page.lower or page.higher %}
    <nav id="pageNavigation" class="post-nav">
        {% if page.lower %}
        <a class="nav-link next" href="{{ page.lower.permalink }}" rel="next">
            <span class="nav-label">‹ Next</span>
            <span class="nav-title">{{ page.lower.title }}</span>
        </a>
        {% endif %}
        {% if page.higher %}
        <a class="nav-link previous" href="{{ page.higher.permalink }}" rel="prev">
            <span class="nav-label">Previous ›</span>
            <span class="nav-title">{{ page.higher.title }}</span>
        </a>
        {% endif %}
    </nav>
    {% endif %}
    <div id="fade-out-bottom"></div>
</main>
{% endblock content %}